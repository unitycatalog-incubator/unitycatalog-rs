{
  "name": "catalog_lifecycle",
  "description": "Complete catalog lifecycle journey: create, get, update, delete catalog",
  "variables": {
    "catalog_name": "test_catalog_lifecycle",
    "storage_root": "s3://test-bucket/catalogs/",
    "initial_comment": "Initial test catalog",
    "updated_comment": "Updated test catalog description"
  },
  "steps": [
    {
      "id": "create_catalog",
      "description": "Create a new managed catalog",
      "method": "POST",
      "path": "/catalogs",
      "request_body": {
        "name": "{catalog_name}",
        "storage_root": "{storage_root}",
        "comment": "{initial_comment}",
        "properties": {
          "environment": "test",
          "team": "data-engineering"
        }
      },
      "expected_status": 201,
      "expected_response": {
        "name": "{catalog_name}",
        "comment": "{initial_comment}",
        "storage_root": "{storage_root}",
        "properties": {
          "environment": "test",
          "team": "data-engineering"
        },
        "owner": "test-user",
        "created_at": 1699564800000,
        "updated_at": 1699564800000,
        "catalog_type": "MANAGED_CATALOG",
        "provider_name": null,
        "share_name": null,
        "isolation_mode": "OPEN",
        "options": {},
        "effective_predictive_optimization_flag": {
          "value": "INHERIT",
          "inherited_from_type": "SYSTEM_DEFAULT"
        }
      },
      "extract_variables": {
        "catalog_id": "$.name",
        "created_at": "$.created_at"
      },
      "tags": ["setup", "create"]
    },
    {
      "id": "get_catalog",
      "description": "Retrieve the created catalog",
      "method": "GET",
      "path": "/catalogs/{catalog_name}",
      "expected_status": 200,
      "expected_response": {
        "name": "{catalog_name}",
        "comment": "{initial_comment}",
        "storage_root": "{storage_root}",
        "properties": {
          "environment": "test",
          "team": "data-engineering"
        },
        "owner": "test-user",
        "created_at": 1699564800000,
        "updated_at": 1699564800000,
        "catalog_type": "MANAGED_CATALOG",
        "provider_name": null,
        "share_name": null,
        "isolation_mode": "OPEN",
        "options": {},
        "effective_predictive_optimization_flag": {
          "value": "INHERIT",
          "inherited_from_type": "SYSTEM_DEFAULT"
        }
      },
      "depends_on": ["create_catalog"],
      "tags": ["main", "read"]
    },
    {
      "id": "update_catalog",
      "description": "Update catalog comment and properties",
      "method": "PATCH",
      "path": "/catalogs/{catalog_name}",
      "request_body": {
        "comment": "{updated_comment}",
        "properties": {
          "environment": "test",
          "team": "data-engineering",
          "cost-center": "12345"
        }
      },
      "expected_status": 200,
      "expected_response": {
        "name": "{catalog_name}",
        "comment": "{updated_comment}",
        "storage_root": "{storage_root}",
        "properties": {
          "environment": "test",
          "team": "data-engineering",
          "cost-center": "12345"
        },
        "owner": "test-user",
        "created_at": 1699564800000,
        "updated_at": 1699564900000,
        "catalog_type": "MANAGED_CATALOG",
        "provider_name": null,
        "share_name": null,
        "isolation_mode": "OPEN",
        "options": {},
        "effective_predictive_optimization_flag": {
          "value": "INHERIT",
          "inherited_from_type": "SYSTEM_DEFAULT"
        }
      },
      "depends_on": ["get_catalog"],
      "extract_variables": {
        "updated_at": "$.updated_at"
      },
      "tags": ["main", "update"]
    },
    {
      "id": "verify_update",
      "description": "Verify the catalog was updated correctly",
      "method": "GET",
      "path": "/catalogs/{catalog_name}",
      "expected_status": 200,
      "expected_response": {
        "name": "{catalog_name}",
        "comment": "{updated_comment}",
        "storage_root": "{storage_root}",
        "properties": {
          "environment": "test",
          "team": "data-engineering",
          "cost-center": "12345"
        },
        "owner": "test-user",
        "created_at": 1699564800000,
        "updated_at": 1699564900000,
        "catalog_type": "MANAGED_CATALOG",
        "provider_name": null,
        "share_name": null,
        "isolation_mode": "OPEN",
        "options": {},
        "effective_predictive_optimization_flag": {
          "value": "INHERIT",
          "inherited_from_type": "SYSTEM_DEFAULT"
        }
      },
      "depends_on": ["update_catalog"],
      "tags": ["main", "verification"]
    },
    {
      "id": "delete_catalog",
      "description": "Delete the catalog",
      "method": "DELETE",
      "path": "/catalogs/{catalog_name}",
      "expected_status": 200,
      "depends_on": ["verify_update"],
      "continue_on_failure": true,
      "tags": ["cleanup", "delete"]
    },
    {
      "id": "verify_deletion",
      "description": "Verify the catalog was deleted",
      "method": "GET",
      "path": "/catalogs/{catalog_name}",
      "expected_status": 404,
      "expected_response": {
        "error_code": "RESOURCE_DOES_NOT_EXIST",
        "message": "Catalog not found"
      },
      "depends_on": ["delete_catalog"],
      "continue_on_failure": true,
      "tags": ["cleanup", "verification"]
    }
  ],
  "metadata": {
    "author": "Unity Catalog Test Framework",
    "created": "2024-01-15",
    "version": "1.0",
    "tags": ["catalog", "lifecycle", "crud"],
    "estimated_duration_ms": 5000
  }
}
